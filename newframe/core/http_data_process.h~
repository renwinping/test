#ifndef __HTTP_DATA_PROCESS_H__
#define __HTTP_DATA_PROCESS_H__

#include "common_def.h"
#include "tcp_connect.h"


class base_data_process;
class http_data_process:public base_data_process
{
    public:
       http_data_process(tcp_connect * t_cn);


        virtual ~http_base_process();

        virtual size_t process_recv_buf(char *buf, const size_t len);
 

        virtual string* get_send_buf();
         
        virtual void reset();
  
		/****************************以上是五个口子，以下是供底层调用********************************************/
        string &get_head();


		void change_http_status(HTTP_STATUS status, bool if_change_send = true);

		
		void change_to_cansend();


		static void parse_url_para(const string &url_para, map<string, string> &url_para_map);


    protected:		
		virtual size_t process_recv_body(char *buf, size_t len, int &result) = 0;	
		
        virtual void parse_header() = 0;
        virtual void gen_send_head() = 0;
        virtual void recv_finish() = 0;
        virtual void send_finish() = 0;

        void check_head_finish(string &left_str);


        HTTP_STATUS _http_status;
        string _recv_head;
        string _send_head;
        size_t _send_head_len;
        tcp_connect * _cnn;
		int _send_status;	
};



#endif
